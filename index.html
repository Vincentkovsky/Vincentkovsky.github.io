<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://Vincentkovsky.github.io').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.6.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Vincentkovsky&#39;s blog">
<meta property="og:url" content="https:&#x2F;&#x2F;vincentkovsky.github.io&#x2F;index.html">
<meta property="og:site_name" content="Vincentkovsky&#39;s blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://vincentkovsky.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>Vincentkovsky's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Vincentkovsky's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vincentkovsky.github.io/2019/12/14/Note%20for%20MedSigProcess2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vincentkovsky">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincentkovsky's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/14/Note%20for%20MedSigProcess2/" class="post-title-link" itemprop="url">Note for MedSigProcess2</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-12-14 21:09:54" itemprop="dateCreated datePublished" datetime="2019-12-14T21:09:54+08:00">2019-12-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-12-15 23:04:46" itemprop="dateModified" datetime="2019-12-15T23:04:46+08:00">2019-12-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Note-for-MedSigProcess-lesson-2"><a href="#Note-for-MedSigProcess-lesson-2" class="headerlink" title="Note for MedSigProcess lesson 2"></a>Note for MedSigProcess lesson 2</h1><p>URL: <a href="https://www.youtube.com/watch?v=ljQklaTh_ek" target="_blank" rel="noopener">https://www.youtube.com/watch?v=ljQklaTh_ek</a></p>
<h2 id="Independent-component-analysis"><a href="#Independent-component-analysis" class="headerlink" title="Independent component analysis"></a>Independent component analysis</h2><p> 从混合信号（来自多个采集装置）中分离出独立成分并移除心跳等生理信号干扰</p>
<h2 id="EEG去除眼动"><a href="#EEG去除眼动" class="headerlink" title="EEG去除眼动"></a>EEG去除眼动</h2><ol>
<li>EEG（250Hz-2000Hz不等）+HEOG+VEOG (利用HEOG和VEOG建立眼动信号template，建立线性关系并自动化去除)</li>
<li>时频分析：<br> 时域0-cue时间点； 频域8-12Hz（alpha band）-与认知，意识，计划，注意力相关；16-25Hz （beta band）- 与运动表现相关。30-50Hz (gamma band) - 也与认知相关。蓝色表示强度低，红色表示强度高 </li>
</ol>
<h2 id="相关性分析"><a href="#相关性分析" class="headerlink" title="相关性分析"></a>相关性分析</h2><ol>
<li><p>不同脑区之间有同步的激活程度上升</p>
</li>
<li><p>采用不同分析方法会得出不同的结果，如下图所示，所以有时候不一定是实验设计的问题，而是分析方法选择的问题</p>
</li>
</ol>
<p><img src="https://i.loli.net/2019/12/15/NFufbjra5ziMJEK.jpg" alt="1.jpg"></p>
<ol>
<li>下图pre中为右脚受伤病人的步态信号，很明显右脚撑地的时间就短一些。</li>
<li>下图单个周期信号即为从脚部分着地（压力大）到全脚掌着地（压力较小）再到脚部分离地（压力大）再到脚完全离地（压力为0）的压力信号的pattern。</li>
<li>下图post为经过跑步机训练后的步态信号，在部分周期中右脚撑地时间甚至比左脚更久</li>
</ol>
<p><img src="https://i.loli.net/2019/12/15/Zpm8D4PYEevtfN9.jpg" alt="2.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vincentkovsky.github.io/2019/12/14/Note%20for%20MedSigProcess1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vincentkovsky">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincentkovsky's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/14/Note%20for%20MedSigProcess1/" class="post-title-link" itemprop="url">Note for MedSigProcess1</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-12-14 11:36:51 / Modified: 17:42:57" itemprop="dateCreated datePublished" datetime="2019-12-14T11:36:51+08:00">2019-12-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Note-for-MedSigProcess-lesson-1"><a href="#Note-for-MedSigProcess-lesson-1" class="headerlink" title="Note for MedSigProcess lesson 1"></a>Note for MedSigProcess lesson 1</h1><p>URL: <a href="https://www.youtube.com/watch?v=JxYGcmxviz8&amp;feature=youtu.be" target="_blank" rel="noopener">https://www.youtube.com/watch?v=JxYGcmxviz8&amp;feature=youtu.be</a><br>脑神经活化和脑血氧变化的区别， coupling between neuron and vessel</p>
<h2 id="非侵入式测量（运动生理特征）"><a href="#非侵入式测量（运动生理特征）" class="headerlink" title="非侵入式测量（运动生理特征）"></a>非侵入式测量（运动生理特征）</h2><p> EEG<br> NIRS<br> ECG<br> EMG<br> Respiration band （position）<br> LIBERTY 动作追踪 （position）<br> Footswitch （压力电信号）</p>
<h2 id="信号的交互干扰移除"><a href="#信号的交互干扰移除" class="headerlink" title="信号的交互干扰移除"></a>信号的交互干扰移除</h2><p> 脑电波+眼动/脸部肌电<br> 脑血氧+心跳/呼吸<br> 呼吸肌电+心跳</p>
<h2 id="信号间的相关性（建立联系）"><a href="#信号间的相关性（建立联系）" class="headerlink" title="信号间的相关性（建立联系）"></a>信号间的相关性（建立联系）</h2><p> 脑电波&amp;肌电信号<br> 肌电信号&amp;呼吸<br> 步态&amp;脑电波/脑血氧<br> 步态&amp;肌电信号</p>
<h2 id="事件的自动检测（例如在…时间点迈了左脚）"><a href="#事件的自动检测（例如在…时间点迈了左脚）" class="headerlink" title="事件的自动检测（例如在…时间点迈了左脚）"></a>事件的自动检测（例如在…时间点迈了左脚）</h2><p> 运动或脑功能状态</p>
<h2 id="量化生理变化时长"><a href="#量化生理变化时长" class="headerlink" title="量化生理变化时长"></a>量化生理变化时长</h2><p> 例如走路时每步站立时长</p>
<h2 id="信号分析步骤"><a href="#信号分析步骤" class="headerlink" title="信号分析步骤"></a>信号分析步骤</h2><p> Data input, filtering/resampling, denoising, pre-processing, spectrum   analysis, correlation/coherence analysis, statistics analysis, data output.</p>
<h2 id="信号分析目标"><a href="#信号分析目标" class="headerlink" title="信号分析目标"></a>信号分析目标</h2><p> 人工挑选好的信号（每个人的信号都不一样），去除生理与一起干扰<br> 在时间轴或频率域强度上量化信号改变量，更进阶 时频分析（时域和频率域同时考虑）<br> 特征获取和识别<br> 信号、行为相关性分析</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vincentkovsky.github.io/2019/12/08/EEG-informed%20fMRI%20integration%20methods/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vincentkovsky">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincentkovsky's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/08/EEG-informed%20fMRI%20integration%20methods/" class="post-title-link" itemprop="url">EEG-informed fMRI integration methods</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-12-08 18:21:41 / Modified: 18:38:46" itemprop="dateCreated datePublished" datetime="2019-12-08T18:21:41+08:00">2019-12-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="EEG-informed-fMRI-integration-methods"><a href="#EEG-informed-fMRI-integration-methods" class="headerlink" title="EEG-informed fMRI integration methods:"></a>EEG-informed fMRI integration methods:</h1><p>Data integration methods for mapping brain networks are subdivided into two types: univariate and multivariate methods. Univariate methods usually select only a single time-course representative of the phenomena of interest and then extract temporal or spectral features to predict BOLD changes. (EEG-informed) And multivariate methods take multiple EEG channels into consideration. </p>
<h2 id="Univariate-methods"><a href="#Univariate-methods" class="headerlink" title="Univariate methods:"></a>Univariate methods:</h2><p>If a limited set of electrodes can reflect the phenomenon of interest of neural activity, the analyses can be concentrated on these electrodes. (Goldman et al., 2002) Fluctuations with a specific temporal structure can be extracted from the EEG using linear prediction algorithms only if the prior knowledge about the frequency and location of the sources of interest to be isolated is known. (Ferdowsi et al., 2015) The most commonly used spatial filtering strategy in this context is temporal ICA. (Leite et al., 2013) The most challenging part in ICA is the selection of ICs that best reflect the phenomenon of interest, and there are different selection criteria. In a visual inspection method, spatial patterns resembling that expected for a given activity of interest should be found in the IC topographies. (Debener et al., 2005). The events of interest can also be identified by inspecting the temporal dynamics of the IC time-courses. (Jann et al., 2008) If more than one EEG acquisition is performed, the reproducibility of the ICs across runs should also be considered. (Leite et al., 2013)</p>
<p>Take epilepsy as example, the EEG is visually inspected for events of interest in the simplest approach of integrating EEG and fMRI. Inter-ictal epileptiform discharges (IEDs) are modeled as stick functions, and ictal activity is modeled as boxcar functions (Leal et al., 2016). These epileptic events can be divided into different states and then the representation of the seizure dynamics can be even finer. (Thornton et al., 2010) </p>
<p>More complex transfer functions based on time-frequency decompositions of the EEG signal between EEG and BOLD signals have been implemented to account for the rich temporal and spectral profiles of the EEG. (Scheeringa et al.,2008) In a GLM analysis, with regressors including the EEG power over multiple frequency bands, the individual contribution to the BOLD signal and the interactions can be clarified. (de Munck et al., 2009) </p>
<h2 id="Multivariate-methods"><a href="#Multivariate-methods" class="headerlink" title="Multivariate methods:"></a>Multivariate methods:</h2><p>Compared to univariate methods, multivariate methods utilize data from multiple EEG channels and can capture spatial information. </p>
<p>Based on the hypothesis that resting-state networks are reflected in both EEG and BOLD signals, there are studies on BOLD correlates of EEG microstates. By spatially correlating the simultaneous EEG topographies with EEG microstates, spontaneous BOLD fluctuations occurring during rest can be predicted. (Yuan et al., 2012) And the EEG microstates can be previously identified by clustering (Britz et al., 2010), ICA (Yuan et al., 2012), or topographic time-frequency decomposition  (Schwab et al., 2015). </p>
<p>Other multivariate methods particularly aim at reflecting functional connectivity across the brain. In order to map the inter- and intra-hemispheric flow of information, the partial directed coherence (a directed measure of functional connectivity) across frequency bands can be correlated with BOLD (Biazoli et al., 2013). Previous study used the phase synchronization index (PSI) computed for a specific frequency and channels and mapped task-dependent BOLD signal changes. (Mizuhara et al. 2005) Another study used global field synchronization (GFS) to predict BOLD changes associated with face integration (Kottlow et al. 2012). </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="en">
    <link itemprop="mainEntityOfPage" href="https://vincentkovsky.github.io/2019/12/01/Note%20for%20chapter%20preprocessing/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Vincentkovsky">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincentkovsky's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/12/01/Note%20for%20chapter%20preprocessing/" class="post-title-link" itemprop="url">Note for chapter preprocessing</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-12-01 21:59:48" itemprop="dateCreated datePublished" datetime="2019-12-01T21:59:48+08:00">2019-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-12-08 20:30:17" itemprop="dateModified" datetime="2019-12-08T20:30:17+08:00">2019-12-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Note-for-chapter-Preprocessing"><a href="#Note-for-chapter-Preprocessing" class="headerlink" title="Note for chapter Preprocessing"></a>Note for chapter <em>Preprocessing</em></h1><hr>
<p>Typically there are 6 steps for fMRI data preprocessing: slice-timing correction, head movement correction, coregistration, normalization, spatial data smoothing and temporal filtering.</p>
<h2 id="Slice-timing-correction"><a href="#Slice-timing-correction" class="headerlink" title="Slice-timing correction"></a>Slice-timing correction</h2><p>Almost all fMRI data are collected in slices and a scan of the whole brain typically include 30 to 75 slices. Interleaved slice acquisition, a common way, collects odd-numbered slices firstly (in ascending order) and then the even-numbered slices (in descending order). The TR is the time between the onsets of consecutive whole-brain scans, and it’s also the time for collecting all slices in one scan. That means there is a time difference (almost one TR long) between the acquisition of the first and last slices. In event-related experiments, slice-timing differences are problematic because subjects quickly alternate between task and rest. Slice-timing correction can be done in either preprocessing or considered in the statistical methods. Assume the TR is T seconds. Then let $ B(T~i~) $ denote the BOLD response collected during the $i$th TR from some voxel of interest. The data acquisition of ith TR begins at$ (i-1)T $and ends at $iT$. So the time $t~i~$ is somewhere in the interval $[(i − 1)T, iT ]$.  The slice-timing difference is corrected by replacing the observed BOLD response $ B(T~i~) $ with estimated BOLD response $B[(i-1)T]$.  The most common solution is temporal interpolation: take the observed values we have and predict the BOLD response at the beginning of the TR. And the most common forms of interpolation are linear, spline, and sinc. Slice-timing correction can also be operated during statistical analysis, and the common way is to choose a flexible model of the hrf that can account for moderate difference in timing.  Friston et al. (1998) proposed the temporal-derivative model, where the hrf is a weighted sum of a standard hrf and the temporal derivative of that hrf (the derivative increases earlier than the hrf and reaches its peak earlier):</p>
<script type="math/tex; mode=display">h(t)=\theta h(t)+\theta \dot h(t)</script><p>But this temporal-derivative model is limited to roughly correct time difference less than the time between the initial peaks of the hrf and its derivative.</p>
<h2 id="Head-motion-correction"><a href="#Head-motion-correction" class="headerlink" title="Head motion correction"></a>Head motion correction</h2><p>Head movement may bring two problems for fMRI data analysis. First, Voxels are defined by their position within the scanner rather than by their position within the subject’s brain. Brain region will move to new spatial locations within the scanner and activations in those regions will be recorded in different voxels than before the head movement. Second, head movements can change the BOLD responses and these BOLD responses are hard to be discriminated from task-related BOLD responses. And prevention methods like restraint devices and head motion reduction training are more often used than correction.<br>Correction for motion-induced location change: Since head movements in fMRI experiments are small, the brain will not change shape or size. Therefore the correcting for movement-induced location changes becomes a problem for rigid-body registration. As a common method, it assumes that the activation in most voxels are identical across TRs, and then takes the BOLD responses from the first or middle TR, finally perform rigid-body movements on the data from each other TR until the BOLD responses from the other TR agree as closely as possible with BOLD responses from the standard TR.<br>Any (three-dimensional) rigid-body movement can be described by six parameters:$ θ~x~,θ~y~,θ~z~,b~x~,b~y~,b~z~$. The formula is</p>
<script type="math/tex; mode=display">\left[\begin{array}{l}{u_{x}} \\ {u_{y}} \\ {u_{z}}\end{array}\right]=\left[\begin{array}{ccc}{1} & {0} & {0} \\ {0} & {\cos \theta_{x}} & {\sin \theta_{x}} \\ {0} & {-\sin \theta_{x}} & {\cos \theta_{x}}\end{array}\right]\left[\begin{array}{ccc}{\cos \theta_{y}} & {0} & {-\sin \theta_{y}} \\ {0} & {1} & {0} \\ {\sin \theta_{y}} & {0} & {\cos \theta_{y}}\end{array}\right]\left[\begin{array}{ccc}{\cos \theta_{z}} & {\sin \theta_{z}} & {0} \\ {-\sin \theta_{z}} & {\cos \theta_{z}} & {0} \\ {0} & {0} & {1}\end{array}\right]\left[\begin{array}{c}{w_{x}} \\ {w_{y}} \\ {w_{z}}\end{array}\right]+\left[\begin{array}{c}{b_{x}} \\ {b_{y}} \\ {b_{z}}\end{array}\right]</script><h2 id="Coregistration"><a href="#Coregistration" class="headerlink" title="Coregistration"></a>Coregistration</h2><p>The goal is to align the functional and structural images to enhance spatial resolution of the functional data. Automated coregistration relies on algorithms and abandons landmark identification. It creates a frequency histogram of the intensity values in each image firstly, and then replace the intensity value in each voxel with assigned bin number (each voxel has two bin numbers separately from each image). And at last, these bin number pairs are plotted for each voxel. Ideally, the association between bins of aligned images is linear. But a nonlinear association is possible with natural images. To solve this, mutual information is widely used as an alternative measure: mutual information increases as the association between the variables increases. The most popular algorithm for solving the coregistration problem is therefore to find the rigid- body movement that maximizes the mutual information between the histogram bins of the voxels in the two images.</p>
<h2 id="Normalization"><a href="#Normalization" class="headerlink" title="Normalization"></a>Normalization</h2><p>The goal is to register a structural scan to the structural scan from some standard brain. The Talairach atlas was the earliest brain atlas used for normalization. It’s based on a single rather unrepresentative brain which is smaller than the average brain by almost 10 mm in each direction and also flatter than the typical adult brain. Thereby considerable morphing is usually required to register the structural scan of a typical subject to the Talairach atlas. Recent atlases are built from structural MRI data collected from many people and it makes normalization more automated and also conforms to the diversity of human neuroanatomy. Unlike coregistration or head movement correction, images to align in normalization are from different people on different machines. The first step in normalization is to align the images as closely as possible using an affine transformation (optimization algorithm is used to find values of parameters that maximize the mutual information):</p>
<script type="math/tex; mode=display">
\left[\begin{array}{l}{u_{x}} \\ {u_{y}} \\ {u_{z}}\end{array}\right]=\left[\begin{array}{lll}{a_{x x}} & {a_{x y}} & {a_{x z}} \\ {a_{y z}} & {a_{y y}} & {a_{y z}} \\ {a_{z x}} & {a_{z y}} & {a_{z z}}\end{array}\right]\left[\begin{array}{l}{w_{x}} \\ {w_{y}} \\ {w_{z}}\end{array}\right]+\left[\begin{array}{l}{b_{x}} \\ {b_{y}} \\ {b_{z}}\end{array}\right]</script><p>To reduce the differences that the affine transformation can’t handle, local stretching and shrinking are typically required. And nonlinear transformation, any transformation not defined by equation above, is utilized for subtle local stretching and shrinking. The goal of nonlinear normalization is to warp the high- resolution structural image of each of our subjects to a single image that defines the atlas we will use to interpret our results.</p>
<h2 id="Spatial-smoothing"><a href="#Spatial-smoothing" class="headerlink" title="Spatial smoothing"></a>Spatial smoothing</h2><p>In this step, the BOLD value in each voxel is replaced by a weighted average of the BOLD responses in neighboring voxels and the weight is greatest at the voxel being smoothed and decreases with distance. As the statistical models commonly used in fMRI data analysis assume normally distributed noise, and the central limit theorem tells us that smoothing will make the BOLD responses’ distribution more normal to meet assumptions of statistical models firstly. Secondly, smoothing is required by popular methods for solving the multiple comparisons problem which are derived from Gaussian random field theory. Thirdly and the most importantly, smoothing can increase the signal-to-noise ratio and therefore greatly increase the chances of success in an fMRI experiment. Spatial smoothing is implemented by applying a three- dimensional filter or kernel to the BOLD responses.</p>
<script type="math/tex; mode=display">
B_{S}\left(x_{i}, y_{j}, z_{k}\right)=\frac{\sum_{q} \sum_{r} \sum_{s} f_{x}\left(x_{q}-x_{i}\right) f_{y}\left(y_{r}-y_{j}\right) f_{z}\left(z_{s}-z_{k}\right) B\left(x_{q}, y_{r}, z_{s}\right)}{\sum_{q} \sum_{r} \sum_{s} f_{x}\left(x_{q}-x_{i}\right) f_{y}\left(y_{r}-y_{j}\right) f_{z}\left(z_{s}-z_{k}\right)}</script><p>Where$ B(x~i~ ,y~j~  ,z~k~)$ denote the BOLD response at the voxel with spatial coordinates $(x~i~  ,y~j~  ,z~k~)$ and$ f$ is the smoothing kernels along corresponding direction.  For example</p>
<script type="math/tex; mode=display">
f_{x}\left(x-x_{i}\right)=\mathrm{e}^{-\frac{\left(x-x_{i}\right)^{2}}{2 \sigma_{x}^{2}}}</script><p>Which is proportional to the probability density function of a normal distribution with<br>mean $x~i~$ and variance$ σ~x~^2$. With a Gaussian kernel, full width at half maximum ($FWHM~i~$) is equal to</p>
<script type="math/tex; mode=display">
F W H M_{i}=\sqrt{8 \ln 2} \sigma_{i}</script><p>Which measures the width of the kernels and therefore the amount of smoothing. And then</p>
<script type="math/tex; mode=display">
f_{x}\left(x-x_{i}\right)=\exp \left[-\frac{4 \ln 2\left(x-x_{i}\right)^{2}}{F W H M_{x}^{2}}\right]</script><p>According to the matched-filter theorem, the filter that maximizes the signal-to-noise ratio is the one with the same size and shape as the signal (Allen &amp; Mills, 2004). In practice, kernel width (the FWHM) is chose to be between one and three voxel widths which should not be wider than the smallest signal. Because if it’s too narrow, the data will not be smoothed enough. If it’s too wide, the noise will be averaged in and reduce the estimated signal intensity. Moreover, it may fuse separate signals as shown in Figure 5.11 (Fransson, Merbolt, Petersson, Ingvar, &amp; Frahm, 2002).</p>
<p><img src="https://i.loli.net/2019/12/08/JGE6fzQL4ghZn3P.png" alt="image-20191201222039828.png"></p>
<h2 id="Temporal-filtering"><a href="#Temporal-filtering" class="headerlink" title="Temporal filtering"></a>Temporal filtering</h2><p>The goal is to smooths the data (one dimensional time series) at each voxel across neighboring TRs. And it only makes sense as a method to reduce temporal low- frequency noise (unexplained and very slow changes in the BOLD responses- frequencies less than about 0.0083 Hz) while spatial smoothing filters out high- frequency spatial noise. </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Vincentkovsky</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vincentkovsky</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.6.0
  </div>

        








        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  

</body>
</html>
